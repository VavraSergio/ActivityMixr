<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>ActivityMixr</title>
    <link rel="stylesheet" href="styles/style.css">
    <link rel="stylesheet" href="styles/styleIndex.css">

</head>

<body>
    <header>
        <h1><a href="index.html">ActivityMixr</a></h1>
        <p>"The perfect cure for when you're bored!" - Stephen Hawking</p>
        <nav class="main-nav">
            <ul>
                <li><a href="generate.html">Generate</a></li>
                <li><a href="playlist.html">Playlists</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="help.html">Help</a></li>
                <li><a href="report.html">Report</a></li>
            </ul>
        </nav>
    </header>
    <div class="middler">
        <main>
            <div class="welcome-section">
                <h1>Welcome to ActivityMixr!</h1>
                <p>Spice Up Your Day with ActivityMixr</p>
                <p>Hello there! Ready to inject some excitement into your routine? Look no further than ActivityMixr,
                    your ultimate destination for personalized, fun-filled experiences. Whether you're flying solo or
                    planning a group adventure, we've got you covered.</p>
            </div>

            <div class="activity-categories">
                <div class="activity-category">
                    <figure>
                    <img src="https://picsum.photos/200/200?random=2" alt="Creative Pursuits">
                    <figcaption>Creative Pursuits</figcaption>
                    </figure>
                </div>
                <div class="activity-category">
                    <figure>
                    <img src="https://picsum.photos/200/200?random=3" alt="Outdoor Adventures">
                    <figcaption>Outdoor Adventures</figcaption>
                    </figure>
                </div>
                <div class="activity-category">
                    <figure>
                    <img src="https://picsum.photos/200/200?random=1" alt="Musical Escapes">
                    <figcaption>Musical Escapes</figcaption>
                    </figure>
                </div>
            </div>

            <!-- spotify login; testing to see if not using form id makes this easier -->
            <div id="login-status" hidden>
                <form>
                    <p>In order to gain full functionality, please login to Spotify!</p>
                    <button id="spotify-login" type="submit">Login to Spotify</button>
                </form>
             </div>
            <div id="generate-redirect" hidden>
                <form>
                    <p>You are already logged in to Spotify.</p>
                    <p>You can go directly to the generate page using the button below.</p>
                    <a href="generate.html" class="button primary">Go to generate</a>
                    <p>Or, click the button to log out</p>
                    <button id="spotify-logout" type="submit">Logout of Spotify</button>
                </form>
            </div>

            <div class="welcome-section">
                <h2>Why Choose ActivityMixr?</h2>
                <p>Customized Experiences: ActivityMixr curates activities based on your preferences, ensuring a
                    unique and personalized journey.</p>
                <p>Simple and Intuitive: Navigate effortlessly through our user-friendly interface for a seamless
                    experience.</p>
                <p>Connect with Fellow Enthusiasts: Join our community of activity lovers, sharing tips, ideas, and
                    memorable moments.</p>
            </div>
        </main>
    </div>
    <footer>
        Â© 2024 ActivityMixr, LLC
    </footer>

    <script src="scripts/spotify.js"></script>

    <script>
        const clientId = "d774e69457df4fafbd90d6fb8208be05"
        const redirectUri = new URL("./index.html", window.location.href).href

        let accessToken = localStorage.getItem("access_token");

        // Check to see if the accessToken is already in the url
        if ( accessToken )
        {
            document.getElementById("generate-redirect").hidden = false;

        }
        else
        {
            document.getElementById("login-status").hidden = false;
        }
        
        event.preventDefault()

        document.getElementById("spotify-login").addEventListener("click", async () => {
            event.preventDefault();
            [verifier, challenge] = await generateCodeChallenge();
            localStorage.setItem("code_verifier", verifier);
            requestAuthCode(clientId, redirectUri, challenge, "user-read-private user-read-email playlist-modify-private playlist-modify-public")
        })

        document.getElementById("spotify-lougout").addEventListener("click", async() => {
            event.preventDefault();

            localStorage.removeItem("accessToken")
            localStorage.removeItem("code_verifier")
            window.location.reload()
        })
    </script>

</body>

</html>